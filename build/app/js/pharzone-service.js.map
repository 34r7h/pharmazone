{"version":3,"sources":["pharzone-service.es6"],"names":[],"mappings":"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","file":"pharzone-service.js","sourcesContent":["(() => {\n  'use strict';\n\n  class Pharzone {\n    constructor($log, $state, $firebaseObject, $rootScope) {\n/*\n      this.promise = (target, data)=> {\n        $log.debug('Promising data..', target +': '+data);\n        setTimeout(()=> {\n          if (data) {\n            $rootScope.$apply( ()=> {\n              target.data = data;\n            });\n            return target;\n          } else {\n            this.promise($rootScope, data);\n            $log.debug('looking for data..');\n          }\n        }, 500);\n      };\n*/\n      let vm = this;\n      this.test = 'ALL SYSTEMS OPERATIONAL';\n      this.cart = {};\n      this.index = {products:{},users:{},orders:{}};\n\n      /*\n      this.dummyData = {\n        products: [\n          {\n            name: 'Cocaine',\n            url:'cocaine',\n            price: 100,\n            unit: 'g',\n            description: 'party drug often too dilute to benefit users',\n            image: 'http://blog.heart.org/wp-content/uploads/2014/02/cocaine3.jpg'\n          },\n          {\n            name: 'DMT',\n            url:'dmt',\n            price: 130,\n            unit: 'mg',\n            description: 'spiritual drug often associated with enlightenment',\n            image: 'http://masswallpapers.mobi/wp-content/uploads/dmt-crystals-photos-7.jpg'\n          },\n          {\n            name: 'LSD',\n            url:'lsd',\n            price: 12,\n            unit: 'paper',\n            description: 'Known to unlock the unknown',\n            image: 'http://assets.hightimes.com/styles/large/s3/LSD.jpg?itok=bhGTfWkj'\n          },\n          {\n            name: 'Peyote',\n            url: 'peyote',\n            price: 40,\n            unit: 'button',\n            description: 'Aboriginal drug often used in ceremonies and rights-of-passage',\n            image: 'https://media-cdn.tripadvisor.com/media/photo-s/01/43/ba/48/peyote.jpg'\n          },\n          {\n            name: 'Psilocybe Cubensis',\n            url:'psilocybe-cubensis',\n            price: 100,\n            unit: 'g',\n            description: 'A species of psychedelic mushroom whose principal active compounds are psilocybin and psilocin',\n            image: 'http://www.culturamix.com/wp-content/gallery/8-67/psilocybe-cubensis-2.jpg'\n          }\n        ],\n        users:[\n          {\n            name:'irth orbits',\n            email:'irth03@gmail.com',\n            role:'lab',\n            deals:{\n              current:[\n                {\n                  drug: 'lsd',\n                  form:'paper',\n                  price: '100',\n                  unit: 'ml',\n                  qty: '1000'\n                },\n                {\n                  drug: 'dmt',\n                  form: 'crystals',\n                  price: '40',\n                  unit: 'mg',\n                  qty: '500'\n                }\n              ],\n              complete:[\n                {\n                  drug: 'meth',\n                  form: 'crystals',\n                  price: '4',\n                  unit: 'g',\n                  qty: '5000'\n                }\n              ]\n            }\n          },\n          {\n            name:'jah farmer',\n            email:'jaffey@gmail.com',\n            role: 'pharmacist',\n            lab:'undermarket',\n            deals:{\n              current:[\n                {\n                  drug: 'hemmehroid cream',\n                  form:'cream',\n                  price: '20',\n                  unit: '100g',\n                  qty: '100'\n                },\n                {\n                  drug: 'backsporin',\n                  form: 'salve',\n                  price: '55',\n                  unit: '50 mg',\n                  qty: '540'\n                }\n              ],\n              complete:[\n                {\n                  drug: 'sales',\n                  form: 'peer-pressure',\n                  price: '80',\n                  unit: 'interaction',\n                  qty: '40000'\n                }\n              ]\n            }\n          }\n        ],\n        orders:[\n          {\n            items:{},\n            total:100,\n            user:'me'\n          }\n        ]\n      };\n\n\n\n      (()=>{\n        let ref = new Firebase('https://pharzone.firebaseio.com/');\n        var obj = $firebaseObject(ref);\n        obj.products = this.dummyData.products;\n        obj.$save().then(function(ref) {\n          ref.key() === obj.$id; // true\n        }, function(error) {\n          console.log(\"Error:\", error);\n        });\n      })();\n*/\n\n      this.data = {\n\t      db: (()=>{\n\t\t      let ref = new Firebase('https://pharzone.firebaseio.com/');\n\t\t      var dbObj = $firebaseObject(ref).$loaded().then((data)=>{\n\t\t\t      return data;\n\t\t      });\n\t\t      return dbObj;\n\t      })(),\n        products: (()=>{\n          let ref = new Firebase('https://pharzone.firebaseio.com/products');\n          var dbObj = $firebaseObject(ref).$loaded().then((data)=>{\n            angular.forEach(data, (product, key) =>{\n              this.index['products'][product.url] = key;\n            });\n            return data;\n          });\n          return dbObj;\n        })(),\n        users:  (()=>{\n          let ref = new Firebase('https://pharzone.firebaseio.com/users');\n          var dbObj = $firebaseObject(ref).$loaded().then((data)=>{\n            return data;\n          });\n          return dbObj;\n        })(),\n        orders:  (()=>{\n          let ref = new Firebase('https://pharzone.firebaseio.com/orders');\n          var dbObj = $firebaseObject(ref).$loaded().then((data)=>{\n            return data;\n          });\n          return dbObj;\n        })()\n      };\n      /* trying to be clever with data wrangling\n\n      this.db = {};\n      angular.forEach(this.data, (method, key)=>{\n        $log.log(method, key);\n        this.db[key] = method;\n      });\n\n      */\n\n\t    this.api = {\n        promise: (target, data)=> {\n          setTimeout(()=> {\n            if (data) {\n              $rootScope.$apply( ()=> {\n                target.data = data;\n              });\n              return target;\n            } else {\n              this.api.promise(target, data);\n            }\n          }, 500);\n        },\n        save: ()=>{\n\n        },\n        make: (type, object)=>{\n           let ref = new Firebase('https://pharzone.firebaseio.com/');\n           var obj = $firebaseObject(ref).$loaded().then((data)=>{\n             let lastIndex = data[type].length;\n             data.products[lastIndex] = object;\n             data.$save().then(function(ref) {\n               ref.key() === obj.$id; // true\n             }, function(error) {\n               console.log(\"Error:\", error);\n             });\n           });\n\n\n\n          /*if(!this.data[type].object){\n            let length = this.data[type].length;\n            this.data[type][length]=object;\n            this.data[type].$save();\n          }*/\n        },\n        getTime: () => {\n          return Date.now();\n        },\n\t\t    addToCart: (product, cart, qty) => {\n          if(!qty) qty = 1;\n          product['qty']= qty;\n          if(cart[product.name]){\n            console.log('Already in cart.');\n          } else {\n            cart[product.name]=product;\n            return cart;\n          }\n\n\t      },\n        cartTotal: (items) => {\n          // $log.debug('calculating totals', items);\n          var total = 0;\n          angular.forEach(items, (item)=>{\n            var itemTotal = item.price * item.qty;\n            total = total + itemTotal;\n          });\n          return total;\n        },\n        checkout: (order, orderTotal, time, vm) => {\n          // var timestamp = Date.now();\n          order.total = orderTotal;\n//        this.data.orders[time]=order;\n\n        if(this.data.orders){\n          this.data.orders.$$state.value[time]=order;\n          this.data.orders.$$state.value.$save();\n        }\n        // TODO wire to db\n        var href = $state.href(\"pharzone.cart.payment\", { order: time });\n        $state.go('pharzone.cart.payment',{order:time});\n        }\n\t    }\n    }\n\n    get() {\n      return 'Pharzone';\n    }\n  }\n\n  /**\n   * @ngdoc service\n   * @name pharzone.service:Pharzone\n   *\n   * @description\n   *\n   */\n  angular\n    .module('pharzone')\n    .service('Pharzone', Pharzone);\n}());\n"],"sourceRoot":"/source/"}